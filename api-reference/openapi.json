{"openapi":"3.1.0","info":{"title":"个人项目 copy copy","description":"","version":"1.0.0"},"tags":[{"name":"Session"},{"name":"Dataset"},{"name":"Data source"}],"paths":{"/v1/sessions":{"post":{"summary":"Create session","deprecated":false,"description":"Creates a session. \nA session refers to the continuous interaction between the user and Powerdrill within a conversation. Your team can have up to 150 sessions simultaneously. If the limit is reached, you can remove unnecessary sessions to make space for new ones.","tags":["Session"],"parameters":[{"name":"x-pd-api-agent-id","in":"header","description":"The ID of the data agent. If not specified, the general mode will be used.","required":true,"example":"agent-cm360zba3002q01l1hkhtinvi","schema":{"type":"string"}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"title":{"type":"string","description":"The session name."},"languageType":{"type":"string","title":"输出语言类型","description":"The language in which the output is generated.","enum":["AUTO","EN","ES","AR","PT","ID","JA","RU","HI","FR","DE","VI","TR","PL","IT","KO","ZH-CN","ZH-TW"]},"jobMode":{"type":"string","description":"Job mode. ","enum":["AUTO","DATA_ANALYTICS"]},"maxMessagesInContext":{"type":"integer","description":"The maximum number of messages retained per session.","minimum":0,"maximum":10}},"required":["title"]},"example":{"title":"New Title","languageType":"AUTO","jobMode":"AUTO","maxMessagesInContext":10}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"description":"The returned data object.","type":"object","properties":{"id":{"type":"string","description":"The session ID."}},"required":["id"]}},"required":["data","code"]},"examples":{"1":{"summary":"成功示例","value":{"code":0,"data":{"id":"session-dasfasdgasdgfasdgasdg"}}}}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]},"get":{"summary":"List sessions","deprecated":false,"description":"Lists sessions in your team.","tags":["Session"],"parameters":[{"name":"pageNumber","in":"query","description":"The number of pages to display.","required":false,"schema":{"type":"integer"}},{"name":"pageSize","in":"query","description":"The number of items on a single page.","required":false,"schema":{"type":"integer"}},{"name":"x-pd-api-agent-id","in":"header","description":"The ID of the data agent. If not specified, the general mode will be used.","required":true,"example":"agent-cm360zba3002q01l1hkhtinvi","schema":{"type":"string"}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"type":"object","properties":{"total":{"type":"integer","description":"The total number of pages."},"pageNumber":{"type":"integer","description":"The number of pages returned."},"pageSize":{"type":"integer","description":"The number of items displayed per page."},"records":{"type":"array","items":{"type":"object","properties":{"id":{"type":"string","description":"The session ID."},"title":{"type":"string","description":"The session name."},"languageType":{"type":"string","title":"输出语言类型","description":"The language in which the output is generated.","enum":["AUTO","EN","ES","AR","PT","ID","JA","RU","HI","FR","DE","VI","TR","PL","IT","KO","ZH-CN","ZH-TW"]},"jobMode":{"type":"string","description":"Job mode. ","enum":["AUTO","DATA_ANALYTICS"]},"maxMessagesInContext":{"type":"integer","description":"The maximum number of messages retained per session.","minimum":1,"maximum":10}},"description":"The information about each record.","required":["title","languageType","maxMessagesInContext","jobMode","id"]},"description":"The list of records contained in the session."}},"required":["total","pageNumber","pageSize","records"],"description":"The returned data object."}},"required":["data","code"]},"examples":{"1":{"summary":"成功示例","value":{"code":0,"data":{"total":22,"pageNumber":5,"pageSize":97,"records":[{"id":"zm8hwAX4WEa_l2Ap69qs1","title":"New Chat","languageType":"EN","jobMode":"DATA_ANALYTICS","maxMessagesInContext":10}]}}}}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]}},"/v1/sessions/{sessionId}":{"patch":{"summary":"Modify session","deprecated":false,"description":"Modifies the configuration of the specified session.","tags":["Session"],"parameters":[{"name":"sessionId","in":"path","description":"The ID of the session to modify.","required":true,"schema":{"type":"string"}},{"name":"x-pd-api-agent-id","in":"header","description":"The ID of the data agent. If not specified, the general mode will be used.","required":true,"example":"agent-cm360zba3002q01l1hkhtinvi","schema":{"type":"string"}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"title":{"type":"string","description":"The session name."},"languageType":{"type":"string","title":"输出语言类型","description":"The language in which the output is generated.","enum":["AUTO","EN","ES","AR","PT","ID","JA","RU","HI","FR","DE","VI","TR","PL","IT","KO","ZH-CN","ZH-TW"]},"jobMode":{"type":"string","description":"Job mode. ","enum":["AUTO","DATA_ANALYTICS"]},"maxMessagesInContext":{"type":"integer","description":"The maximum number of messages retained per session.","minimum":0,"maximum":10}},"required":["title","languageType","jobMode","maxMessagesInContext"]},"example":""}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"type":"object","properties":{},"title":"业务数据","description":"Null is returned when the operation is successful."}},"required":["data","code"]}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]},"delete":{"summary":"Delete session","deprecated":false,"description":"Deletes a session. Once deleted, both the session and its job history will be permanently removed and cannot be recovered.","tags":["Session"],"parameters":[{"name":"sessionId","in":"path","description":"The session ID.","required":true,"schema":{"type":"string"}},{"name":"x-pd-api-agent-id","in":"header","description":"The ID of the data agent. If not specified, the general mode will be used.","required":true,"example":"agent-cm360zba3002q01l1hkhtinvi","schema":{"type":"string"}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"type":"object","properties":{},"description":"Null is returned when the operation is successful."}},"required":["code"]}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]},"get":{"summary":"Get session","deprecated":false,"description":"Obtains information about the specified session.","tags":["Session"],"parameters":[{"name":"sessionId","in":"path","description":"The session ID.","required":true,"schema":{"type":"string"}},{"name":"x-pd-api-agent-id","in":"header","description":"The ID of the data agent. If not specified, the general mode will be used.","required":true,"example":"agent-cm360zba3002q01l1hkhtinvi","schema":{"type":"string"}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"$ref":"#/components/schemas/SessionModelDTO"}},"required":["data","code"]}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]}},"/v1/sessions/{sessionId}/history":{"get":{"summary":"Get job history in session","deprecated":false,"description":"Obtains the job history contained in the specified session.","tags":["Session"],"parameters":[{"name":"sessionId","in":"path","description":"The session ID.","required":true,"schema":{"type":"string"}},{"name":"pageNumber","in":"query","description":"The number of pages to display.","required":false,"schema":{"type":"integer"}},{"name":"pageSize","in":"query","description":"The number of items on a single page.","required":false,"schema":{"type":"integer"}},{"name":"x-pd-api-agent-id","in":"header","description":"The ID of the data agent. If not specified, the general mode will be used.","required":true,"example":"agent-cm360zba3002q01l1hkhtinvi","schema":{"type":"string"}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"type":"object","properties":{"total":{"type":"integer","description":"The total number of pages displayed."},"pageNumber":{"type":"integer","description":"The number of pages returned."},"pageSize":{"type":"integer","description":"The number of items displayed per page."},"records":{"type":"array","items":{"description":"The information about each record.","type":"object","properties":{"question":{"description":"The user's question.","type":"object","properties":{"blocks":{"type":"array","items":{"type":"object","properties":{"type":{"type":"string","enum":["MESSAGE","CODE","TABLE","IMAGE","SOURCES","QUESTIONS"],"description":"The block type."},"content":{"type":"string","description":"The block content."}},"required":["type","content"]}}},"required":["blocks"]},"answer":{"description":"The answer to the question.","type":"object","properties":{"blocks":{"type":"array","items":{"$ref":"#/components/schemas/BlockDTO"}}},"required":["blocks"]},"jobId":{"type":"string","description":"The job ID."}},"required":["question","answer","jobId"]},"description":"The list of returned records."}},"required":["total","pageNumber","pageSize","records"],"description":"The returned data object."}},"required":["data","code"]},"examples":{"1":{"summary":"成功示例","value":{"code":0,"data":{"total":0,"pageNumber":1,"pageSize":10,"records":[{"jobId":"job-1dsfasddfasgddsaffds","question":{"blocks":[{"type":"MESSAGE","content":"Check for negative values across all sales columns"}]},"answer":{"blocks":[{"type":"MESSAGE","content":"- Check for negative values across all sales columns.\n- Filter the DataFrame to retain only rows with no negative sales values.","groupId":"ba582fc9-bb36-4c5d-a8e8-d35bda6389cd","groupName":"Identify the channels with negative sales values by examining each day's sales data. Filter out the rows where any sales value is negative.","stage":"Analyze"},{"type":"CODE","content":"```python\n\nimport pandas as pd\n\ndef invoke(input_0: pd.DataFrame) -> pd.DataFrame:\n    '''\n    input_0: pd.DataFrame  SalesByChannelByDay_Summary_Demo.Sheet1_0_table_1.csv\n    '''\n    # Identify columns that represent sales data (all except the first column)\n    sales_columns = input_0.columns[1:]\n    \n    # Filter rows where any sales value is negative\n    filtered_df = input_0[~(input_0[sales_columns] < 0).any(axis=1)]\n    \n    # Assign the result to the output variable\n    output = filtered_df\n    \n    return output\n\n```","groupId":"ba582fc9-bb36-4c5d-a8e8-d35bda6389cd","groupName":"Identify the channels with negative sales values by examining each day's sales data. Filter out the rows where any sales value is negative.","stage":"Analyze"},{"type":"TABLE","content":"https://s3.amazonaws.com/powerdrilltest/tmp_datasource_cache/code_result/clvl4cad2001q01l1m522hxlu/baf7d6d1-fb81-4fdb-bcdd-32923d214c7b.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20241018T104617Z&X-Amz-SignedHeaders=host&X-Amz-Expires=599&X-Amz-Credential=AKIARLSQLXURHEIDN4OZ%2F20241018%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=9bcb5af552793f162e35f41d62fb9306cf90888924bfbdce81ea687265fddf83","groupId":"ba582fc9-bb36-4c5d-a8e8-d35bda6389cd","groupName":"Identify the channels with negative sales values by examining each day's sales data. Filter out the rows where any sales value is negative.","stage":"Analyze"},{"type":"MESSAGE","content":"- Sum the sales across all days for each channel.\n- Create a new DataFrame with the channel names and their corresponding total sales.","groupId":"47183fd1-307b-4408-9986-e9238d952ec1","groupName":"Calculate the overall sales trend for the identified channels with negative sales values. This involves summing up the sales across all days for each channel and analyzing the trend.","stage":"Analyze"},{"type":"CODE","content":"```python\n\nimport pandas as pd\n\ndef invoke(negative_sales_channels: pd.DataFrame) -> pd.DataFrame:\n    '''\n    negative_sales_channels: pd.DataFrame  negative_sales_channels.csv\n    '''\n    # Sum the sales across all days for each channel\n    total_sales = negative_sales_channels.iloc[:, 1:].sum(axis=1)\n    \n    # Create a new DataFrame with the channel names and their corresponding total sales\n    output = pd.DataFrame({\n        'Channel': negative_sales_channels.iloc[:, 0],\n        'Total Sales': total_sales\n    })\n    \n    return output\n\n```","groupId":"47183fd1-307b-4408-9986-e9238d952ec1","groupName":"Calculate the overall sales trend for the identified channels with negative sales values. This involves summing up the sales across all days for each channel and analyzing the trend.","stage":"Analyze"},{"type":"TABLE","content":"https://s3.amazonaws.com/powerdrilltest/tmp_datasource_cache/code_result/clvl4cad2001q01l1m522hxlu/10cffac2-8bf3-45f4-86e6-1ed8457329f2.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20241018T104617Z&X-Amz-SignedHeaders=host&X-Amz-Expires=600&X-Amz-Credential=AKIARLSQLXURHEIDN4OZ%2F20241018%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=c6f5b522d2ddceea730304b86a45d5f5165f05f9fda3c1d275d11e9022c1e7ac","groupId":"47183fd1-307b-4408-9986-e9238d952ec1","groupName":"Calculate the overall sales trend for the identified channels with negative sales values. This involves summing up the sales across all days for each channel and analyzing the trend.","stage":"Analyze"},{"type":"MESSAGE","content":"- Replace any negative sales values with zero in the data.\n- Sum the sales across all days for each channel.\n- Create a new data structure with the summed sales values.","groupId":"6b93c2b1-8908-4c2b-afb2-2a81f2d24739","groupName":"Calculate the overall sales trend for the same channels but excluding the negative sales values. This involves setting negative values to zero or removing them and then summing up the sales across all days for each channel.","stage":"Analyze"},{"type":"CODE","content":"```python\n\nimport pandas as pd\n\ndef invoke(negative_sales_channels: pd.DataFrame) -> pd.DataFrame:\n    '''\n    negative_sales_channels: pd.DataFrame  negative_sales_channels.csv\n    '''\n    # Replace negative values with zero\n    negative_sales_channels.iloc[:, 1:] = negative_sales_channels.iloc[:, 1:].clip(lower=0)\n    \n    # Sum the sales across all days for each channel\n    sales_sum = negative_sales_channels.iloc[:, 1:].sum(axis=1)\n    \n    # Create a new DataFrame with the summed sales values\n    output = pd.DataFrame({\n        'Channel': negative_sales_channels.iloc[:, 0],\n        'Total Sales': sales_sum\n    })\n    \n    return output\n\n```","groupId":"6b93c2b1-8908-4c2b-afb2-2a81f2d24739","groupName":"Calculate the overall sales trend for the same channels but excluding the negative sales values. This involves setting negative values to zero or removing them and then summing up the sales across all days for each channel.","stage":"Analyze"},{"type":"TABLE","content":"https://s3.amazonaws.com/powerdrilltest/tmp_datasource_cache/code_result/clvl4cad2001q01l1m522hxlu/f4c99616-dd7c-48b1-8a35-d3141d732c36.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20241018T104617Z&X-Amz-SignedHeaders=host&X-Amz-Expires=600&X-Amz-Credential=AKIARLSQLXURHEIDN4OZ%2F20241018%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=d21a8d939ab09547bc201754ba253ca6c0d1da5361752f2228237e3ff59be256","groupId":"6b93c2b1-8908-4c2b-afb2-2a81f2d24739","groupName":"Calculate the overall sales trend for the same channels but excluding the negative sales values. This involves setting negative values to zero or removing them and then summing up the sales across all days for each channel.","stage":"Analyze"},{"type":"MESSAGE","content":"- Merge the two datasets on the 'Channel' column to align sales data for comparison.\n- Calculate the difference in 'Total Sales' between the datasets for each channel.\n- Store the results, including channel name and calculated difference, in a new dataset.","groupId":"3488f538-f7fc-4c0e-a265-b66e3a38d41e","groupName":"Compare the sales trends with and without negative sales values to determine the impact of negative sales on the overall sales trend for the affected channels.","stage":"Analyze"},{"type":"CODE","content":"```python\n\nimport pandas as pd\n\ndef invoke(sales_trend_with_negatives: pd.DataFrame, sales_trend_without_negatives: pd.DataFrame) -> pd.DataFrame:\n    # Merge the two DataFrames on the 'Channel' column\n    merged_df = pd.merge(sales_trend_with_negatives, sales_trend_without_negatives, on='Channel', suffixes=('_with_negatives', '_without_negatives'))\n    \n    # Calculate the difference in 'Total Sales' between the two DataFrames\n    merged_df['Sales Difference'] = merged_df['Total Sales_without_negatives'] - merged_df['Total Sales_with_negatives']\n    \n    # Create a new DataFrame to store the results\n    output = merged_df[['Channel', 'Sales Difference']]\n    \n    return output\n\n```","groupId":"3488f538-f7fc-4c0e-a265-b66e3a38d41e","groupName":"Compare the sales trends with and without negative sales values to determine the impact of negative sales on the overall sales trend for the affected channels.","stage":"Analyze"},{"type":"TABLE","content":"https://s3.amazonaws.com/powerdrilltest/tmp_datasource_cache/code_result/clvl4cad2001q01l1m522hxlu/aaf4f2f7-e2db-4f2e-98ae-0bdd18f42333.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20241018T104617Z&X-Amz-SignedHeaders=host&X-Amz-Expires=600&X-Amz-Credential=AKIARLSQLXURHEIDN4OZ%2F20241018%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=19fcfe97c70bf40292b920ecbf0299c101e1de11e49b54fb8f62934b6e874f52","groupId":"3488f538-f7fc-4c0e-a265-b66e3a38d41e","groupName":"Compare the sales trends with and without negative sales values to determine the impact of negative sales on the overall sales trend for the affected channels.","stage":"Analyze"},{"type":"MESSAGE","content":"\n\n`Analyzing Conclusions` \n\n### The impact of negative sales values on overall sales trends\n\n#### Sales variance analysis\n\n","groupId":"fd1a62e6-48cf-4ac1-8bac-025665444710","groupName":"Conclusions","stage":"Respond"},{"type":"TABLE","content":"https://s3.amazonaws.com/powerdrilltest/tmp_datasource_cache/code_result/clvl4cad2001q01l1m522hxlu/aaf4f2f7-e2db-4f2e-98ae-0bdd18f42333.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20241018T104617Z&X-Amz-SignedHeaders=host&X-Amz-Expires=600&X-Amz-Credential=AKIARLSQLXURHEIDN4OZ%2F20241018%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=19fcfe97c70bf40292b920ecbf0299c101e1de11e49b54fb8f62934b6e874f52","groupId":"fd1a62e6-48cf-4ac1-8bac-025665444710","groupName":"Conclusions","stage":"Respond"},{"type":"MESSAGE","content":"\n\n- **Sales variance**：In all channels (including EC, JD, Tmall, WeChat, retail, corporate stores, outlets, and total), the sales difference is 0.0. This indicates that regardless of the presence of negative sales values, the sales trend has not changed.\n\n#### Conclusion and Insights\n- **The impact of negative sales values**：Based on the provided data, negative sales values have no impact on the overall sales trend of the affected channels, as the sales variance for all channels is 0.0.\n- **Data consistency**：The sales discrepancies across all channels are consistent, indicating that there are no anomalies or deviations caused by negative sales values during data processing or analysis.","groupId":"fd1a62e6-48cf-4ac1-8bac-025665444710","groupName":"Conclusions","stage":"Respond"},{"type":"SOURCES","content":[{"source":"SalesByChannelByDay_Summary_Demo.xlsx","datasourceId":"cm2ej4wmo000001fcdkwbdrml","datasetId":"cm2ej4vx900hp01l1o378zr9o","fileType":"xlsx","externalId":""}],"groupId":"","groupName":"","stage":"Respond"},{"type":"QUESTIONS","content":["Analyze the specific channels with negative sales values on different dates and discuss whether the sales strategies of these channels might lead to negative values.","Study the long-term impact of negative sales values on overall sales trends and assess whether adjustments to data analysis methods are needed to more accurately reflect the actual situation.","Investigate the source of negative sales values, whether they are related to returns, discounts, or other factors, and propose possible solutions to reduce the occurrence of negative values."],"groupId":"-1","stage":"Respond"}]}}]}}}}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]}},"/v1/datasets":{"post":{"summary":"Create dataset","deprecated":false,"description":"Creates a dataset. \nA dataset is a collection of data sources organized for specific purposes. You can create multiple datasets to group and store data sources based on different needs.","tags":["Dataset"],"parameters":[{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string","description":"The dataset name."},"description":{"type":"string","description":"The dataset description."}},"required":["name"]},"example":{"name":"My dataset","description":"my default dataset"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"type":"object","properties":{"id":{"type":"string","description":"The dataset ID."}},"required":["id"]}},"required":["data","code"]},"examples":{"1":{"summary":"成功示例","value":{"code":0,"data":{"id":"dataset-adsdfasafdsfasdgasd"}}}}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]},"get":{"summary":"List datasets","deprecated":false,"description":"Lists datasets in your team or of the specified name.","tags":["Dataset"],"parameters":[{"name":"pageNumber","in":"query","description":"The number of pages to display.","required":false,"schema":{"type":"integer"}},{"name":"pageSize","in":"query","description":"The number of items on a single page.","required":false,"schema":{"type":"integer"}},{"name":"search","in":"query","description":"The dataset name.","required":false,"schema":{"type":"string"}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{}}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"type":"object","properties":{"pageNumber":{"type":"integer","description":"The number of pages returned."},"pageSize":{"type":"integer","description":"The number of items displayed per page."},"total":{"type":"integer","description":"The total number of pages."},"records":{"type":"array","items":{"$ref":"#/components/schemas/DatasetDTO"},"description":"The list of datasets."}},"required":["pageNumber","pageSize","total","records"],"description":"The returned data object."}},"required":["data","code"]},"examples":{"1":{"summary":"成功示例","value":{"code":0,"data":{"pageNumber":1,"pageSize":10,"total":1,"records":[{"id":"dataset-dasfadsgadsgas","name":"mysql","description":"mysql databases"}]}}}}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]}},"/v1/datasets/{datasetId}":{"delete":{"summary":"Delete dataset","deprecated":false,"description":"Deletes the specified dataset. Once deleted, all data sources within the dataset will also be permanently removed and cannot be recovered.","tags":["Dataset"],"parameters":[{"name":"datasetId","in":"path","description":"The dataset ID.","required":true,"schema":{"type":"string"}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"type":"object","properties":{},"description":"Null is returned when the operation is successful."}},"required":["code"]}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]},"patch":{"summary":"Modify dataset","deprecated":false,"description":"Modifies information about the specified dataset.","tags":["Dataset"],"parameters":[{"name":"datasetId","in":"path","description":"The dataset ID.","required":true,"schema":{"type":"string"}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string","description":"The new name of the dataset.`name` and `description` cannot be both blank."},"description":{"type":"string","description":"The new description of the dataset. `name` and `description` cannot be both blank."}}},"example":{"name":"sales_data","description":"sales data of all regions"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"type":"object","properties":{},"description":"Null is returned when the operation is successful."}},"required":["data","code"]}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]}},"/v1/datasets/{datasetId}/status":{"get":{"summary":"Get dataset status","deprecated":false,"description":"Obtains the summary of statuses of the data sources contained in the specified dataset.","tags":["Dataset"],"parameters":[{"name":"datasetId","in":"path","description":"The dataset ID.","required":true,"schema":{"type":"string"}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"type":"object","properties":{"synchedCount":{"type":"integer","description":"The number of data sources that are synchronized."},"invalidCount":{"type":"integer","description":"The number of data sources failed to be synchronized."},"synchingCount":{"type":"integer","description":"The number of data sources are waiting to be synchronized or being synchronized."}},"description":"The returned data object.","required":["synchedCount","invalidCount","synchingCount"]}},"required":["data","code"]},"examples":{"1":{"summary":"成功示例","value":{"code":0,"data":{"synchedCount":5,"invalidCount":0,"synchingCount":0}}}}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]}},"/v1/datasets/{datasetId}/datasources/{datasourceId}/presign":{"post":{"summary":"Presign data source ","deprecated":false,"description":"Generates a presigned URL to access the specified data source.","tags":["Dataset"],"parameters":[{"name":"datasetId","in":"path","description":"The ID of the dataset that contains the target data source.","required":true,"schema":{"type":"string"}},{"name":"datasourceId","in":"path","description":"The data source ID.","required":true,"schema":{"type":"string"}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"expireIn":{"type":"integer","description":"The duration after which the presigned URL will expire. The value is expressed in seconds, and is default to 600.","minimum":1}}},"example":{"expireIn":600}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"type":"object","properties":{"presignedUrl":{"type":"string","description":"The presigned URL to access the data source."},"expireAt":{"type":"string","format":"date-time","description":"The expiration date and time of the presigned URL."}},"required":["presignedUrl","expireAt"],"description":"The returned data object."}},"required":["data","code"]},"examples":{"1":{"summary":"成功示例","value":{"code":0,"data":{"presignedUrl":"string","expireAt":"2024-11-13T14:15:22.123Z"}}}}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]}},"/v1/datasets/{datasetId}/datasources":{"post":{"summary":"Create data source","deprecated":false,"description":"Creates a data source in the specified dataset. ","tags":["Data source"],"parameters":[{"name":"datasetId","in":"path","description":"The dataset ID.","required":true,"schema":{"type":"string"}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string","description":"The name of the data source. If not provided, it will default to the value of `fileName`."},"fileName":{"type":"string","description":"The name of the file."},"type":{"type":"string","description":"The type of the data source."},"url":{"type":"string","description":"The URL of the file for public access. You must specify either `url` or `fileKey`, but not both."},"fileKey":{"type":"string","description":"The object storage path to the file. You must specify either `url` or `fileKey`, but not both."}},"required":["fileName","type"]},"example":{"name":"test.csv","fileName":"test.csv","type":"FILE","url":"https://s3.amazonaws.com/powerdrilltest/user/clvl4cad2001q01l1m522hxlu/upload/f9773f1e-cd68-489a-8121-d566ca9218b1.csv?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20240924T143419Z&X-Amz-SignedHeaders=host&X-Amz-Expires=599&X-Amz-Credential=AKIARLSQLXURHEIDN4OZ%2F20240924%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Signature=9ca0c58d508926a5811818041d557ffb53c64025dae94c0855280d457c7089a2"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"$ref":"#/components/schemas/DatasourceDTO","description":"The returned data object."}},"required":["data","code"]},"examples":{"1":{"summary":"成功示例","value":{"code":0,"data":{"id":"datasource-cadsgfsdagasgadsg","datasetId":"dataset-dagasdgasgasg","name":"test.csv","fileName":"test.csv","type":"FILE","status":"pending"}}}}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]},"get":{"summary":"List data sources","deprecated":false,"description":"Lists data sources contained in the specified dataset.","tags":["Data source"],"parameters":[{"name":"datasetId","in":"path","description":"The dataset ID.","required":true,"schema":{"type":"string"}},{"name":"pageNumber","in":"query","description":"The number of pages to display.","required":false,"example":1,"schema":{"type":"integer"}},{"name":"pageSize","in":"query","description":"The number of items on a single page.","required":false,"example":10,"schema":{"type":"integer"}},{"name":"status","in":"query","description":"The status of data sources to list. Multiple statuses can be specified in a comma-separated list, and data sources matching any will be displayed.","required":false,"example":"synched","schema":{"type":"string","enum":["pending","running","synched","error","usage_limit_reached"]}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"type":"object","properties":{"total":{"type":"integer","description":"The total number of pages."},"pageSize":{"type":"integer","description":"The number of items displayed per page."},"pageNumber":{"type":"integer","description":"The number of pages displayed."},"records":{"type":"array","items":{"$ref":"#/components/schemas/DatasourceDTO","description":"The returned data object."}}},"required":["total","pageSize","pageNumber","records"]}},"required":["data","code"]},"examples":{"1":{"summary":"成功示例","value":{"code":0,"data":{"total":1,"pageSize":10,"pageNumber":1,"records":[{"id":"datasource-cadsgfsdagasgadsg","datasetId":"dataset-dagasdgasgasg","name":"test.csv","fileName":"test.csv","type":"FILE","status":"pending"}]}}}}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]}},"/v1/datasets/{datasetId}/datasources/{datasourceId}":{"delete":{"summary":"Delete data source","deprecated":false,"description":"Deletes the specified data source from the specified dataset. Once deleted, the data source cannot be recovered.","tags":["Data source"],"parameters":[{"name":"datasetId","in":"path","description":"The ID of the dataset that contains the data source.","required":true,"schema":{"type":"string"}},{"name":"datasourceId","in":"path","description":"The data source ID.","required":true,"schema":{"type":"string"}},{"name":"x-pd-api-agent-id","in":"header","description":"The ID of the data agent. If not specified, the general mode will be used.","required":true,"example":"agent-cm360zba3002q01l1hkhtinvi","schema":{"type":"string"}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"type":["object","null"],"properties":{},"description":"Null returned when the operation is successful."}},"required":["code"]}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]},"get":{"summary":"Get data source","deprecated":false,"description":"Obtains information about the specified data source.","tags":["Data source"],"parameters":[{"name":"datasetId","in":"path","description":"The ID of the dataset that contains the data source.","required":true,"schema":{"type":"string"}},{"name":"datasourceId","in":"path","description":"The data source ID. ","required":true,"schema":{"type":"string"}},{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"$ref":"#/components/schemas/DatasourceDTO","description":"The returned data object."}},"required":["data","code"]},"examples":{"1":{"summary":"成功示例","value":{"code":0,"data":{"id":"datasource-cadsgfsdagasgadsg","datasetId":"dataset-dagasdgasgasg","name":"test.csv","fileName":"test.csv","type":"FILE","status":"pending"}}}}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]}},"/v1/datasources":{"post":{"summary":"Create data source without specifying a dataset","deprecated":false,"description":"Creates a data source without specifying a dataset. Powerdrill will automatically create a dataset for it.","tags":["Data source"],"parameters":[{"name":"x-pd-external-trace-id","in":"header","description":"The external trace ID. The length ranges from 0 to 128 characters.","required":false,"example":"3d6ec26eefa34b9abb642df44e347d06.269.17313084000000393","schema":{"type":"string"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"object","properties":{"name":{"type":"string","description":"The name of the data source."},"fileName":{"type":"string","description":"The file name."},"type":{"type":"string","description":"The type of the data source, for example, **FILE**."},"url":{"type":"string","description":"The URL of the file for public access."},"fileKey":{"type":"string","description":"The object storage path to the file."}},"required":["type","fileName"]},"example":{"name":"test.csv","fileName":"test.csv","type":"FILE","url":"string","fileKey":"/tmp/sdgsagdsgsadgasdg"}}}},"responses":{"200":{"description":"","content":{"application/json":{"schema":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "},"data":{"$ref":"#/components/schemas/DatasourceDTO","description":"The returned data object."}},"required":["data","code"]}}},"headers":{"x-pd-trace-id":{"example":"","required":true,"description":"The trace ID of Powerdrill.","schema":{"type":"string"}}}}},"security":[{"apikey-header-x-pd-api-key":[]}]}}},"components":{"schemas":{"DatasourceDTO":{"type":"object","properties":{"id":{"type":"string","description":"The data source ID, which uniquely identifies the data source."},"datasetId":{"type":"string","description":"The dataset ID."},"name":{"type":"string","description":"The data source name."},"fileName":{"type":"string","description":"The file name."},"type":{"type":"string","description":"The type of the data source.","enum":["FILE"]},"status":{"type":"string","title":"文件同步状态","description":"The processing status of the data source.","enum":["pending","running","synched","error","usage_limit_reached"]}},"required":["id","name","type","datasetId","status","fileName"]},"SessionModelDTO":{"type":"object","properties":{"id":{"type":"string","description":"The session ID."},"title":{"type":"string","description":"The session name."},"languageType":{"type":"string","title":"输出语言类型","description":"The language in which the output is generated.","enum":["AUTO","EN","ES","AR","PT","ID","JA","RU","HI","FR","DE","VI","TR","PL","IT","KO","ZH-CN","ZH-TW"]},"jobMode":{"type":"string","description":"Job mode. ","enum":["AUTO","DATA_ANALYTICS"]},"maxMessagesInContext":{"type":"integer","description":"The maximum number of messages retained per session.","minimum":0,"maximum":10}},"required":["id","title","languageType","maxMessagesInContext","jobMode"]},"DatasetDTO":{"type":"object","properties":{"id":{"type":"string","description":"The dataset ID, which uniquely identifies the dataset."},"name":{"type":"string","description":"The dataset name."},"description":{"type":"string","description":"The dataset description."}},"required":["id","name","description"]},"返回模型":{"type":"object","properties":{"code":{"type":"integer","title":"业务码","description":"Status code. **0** indicates that the operation is successful. Otherwise, the operation fails. Possible error codes include: \n- 100: Bad request. \n- 201: Request frequency limit.\n- 9999: Internal error. \n- 100001: Invalid operation. "}},"required":["code"]},"BlockDTO":{"type":"object","properties":{"type":{"type":"string","enum":["MESSAGE","CODE","TABLE","IMAGE","SOURCES","QUESTIONS"],"description":"The block type."},"content":{"type":"string","description":"The block content."},"groupId":{"type":"string","description":"The ID of the group containing the block."},"groupName":{"type":"string","description":"The name of the group containing the block."},"stage":{"type":"string","enum":["Analyze","Respond"],"description":"The stage of the block."}},"required":["type","content","groupId","groupName","stage"]}},"securitySchemes":{"apikey-header-x-pd-api-key":{"type":"apiKey","in":"header","name":"x-pd-api-key"}}},"servers":[]}